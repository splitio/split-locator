<!DOCTYPE html>
<html>
	<head>
		<title>Quantum Metric and Split Unite!</title>
		<style>
			.button {
			  background-color: black;
			  border: none;
			  color: white;
			  padding: 15px 32px;
			  text-align: center;
			  text-decoration: none;
			  display: inline-block;
			  font-size: 16px;
			}
		</style>	
	    <script src="//cdn.split.io/sdk/split-10.15.9.min.js"></script>		
		<script type="text/javascript">
		(function() {
		    var qtm = document.createElement('script'); qtm.type = 'text/javascript'; qtm.async = 1;
		    qtm.src = 'https://cdn.quantummetric.com/qscripts/quantum-split.js';
		    var d = document.getElementsByTagName('script')[0];
		    !window.QuantumMetricAPI && d.parentNode.insertBefore(qtm, d);
		})();

		let client;
		const checkSessionIDExists = setInterval( function() {

			if (window.QuantumMetricAPI != null && window.QuantumMetricAPI.isOn()
				&& window.QuantumMetricAPI.getSessionID() != null) {

				var factory = splitio({
				  core: {
				    authorizationKey: '69haia9b9pf3b0rs951bj8kuufr4ke2987op',
				    key: window.QuantumMetricAPI.getSessionID() // unique identifier for your user
				  },
				  scheduler: {
		            impressionsRefreshRate: 5
	  			  }
				});

				client = factory.client();

				const properties = {
					quantumUrl: window.QuantumMetricAPI.getReplay()
				}
				client.track ('user', 'qmreplay', 0, properties);

				client.on(client.Event.SDK_READY, function() {
				  const treatment = client.getTreatment('volunteer_drive');

				  if (treatment === 'on') {
				  	document.getElementById('donate_button_id').innerHTML = "VOLUNTEER";
				  }   else   if (treatment === 'off') {
				  	document.getElementById('donate_button_id').innerHTML = "DONATE";
				  }   else {
				  	document.getElementById('donate_button_id').innerHTML = "DONATE";
				  }

				});	
	    	    clearInterval(checkSessionIDExists);
		  	}
		}, 100);

		function registerClick() {
			console.log('click');
	        var properties = {
	            region : 'EU',
	            status : 'platinum'
	        };
	        client.track ('user', 'click', 0, properties);
		}

		</script>		
	</head>
	<body>
		<div>
			<img src="http://www.cortazar-split.com/dog_melancholy.jpeg"/>
			<div class="buttons" align="center">
				<button id="donate_button_id" onclick="registerClick()" class="button">DONATE</button>
				<button id="adopt_button_id" class="button">ADOPT</button>
			</div>
		</div>
	</body>
</html>